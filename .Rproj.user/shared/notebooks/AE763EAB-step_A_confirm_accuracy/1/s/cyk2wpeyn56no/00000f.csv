"0","D = diag(colSums(A))"
"0","L = D - A"
"0","L_inv = ginv(L)"
"0","# L_inv"
"0",""
"0","get_marginal_probability <- function(u, v, L_inv, A){"
"0","  w = A[u, v]"
"0","  n = dim(A)[1]"
"0","  chi_uv = base::rep(0, n)"
"0","  chi_uv[u] = 1"
"0","  chi_uv[v] = -1"
"0","  effective_resistance = t(chi_uv) %*% L_inv %*% chi_uv"
"0","  marginal_probability = effective_resistance * w"
"0","  marginal_probability"
"0","}"
